{"name":"Macro Excel  Registri ","tagline":"BY Macr@ris","body":"## Macro Registri x Dany\r\n****************\r\nQuesta semplice macro esegue operazioni basilari quali selezioni dinamici di intervallo di dati,\r\neliminazione di intervallo di dati (range) vuoti, qualche formattazione qua e la' con uso di condizionale\r\n`if...then` , cicli `For...Next`,`offset` e tante altre piccole interessanti nozioni per programmare in Excel\r\n\r\n************************************************************\r\n\r\n### Step #1 Richiesta esecuzione della macro\r\n``` vb\r\nSub registri() 'Nome macro utilizzato per lancio  automatico\r\n'               \r\nDim infos As Variant\r\n    infos = MsgBox(\"Elaborazione Registri...\" & vbNewLine & vbNewLine & _\r\n    \"Qui per sbaglio -->  Click 'NO'\", _\r\n                    vbYesNo + vbInformation + vbDefaultButton2, \"Macr@ris Registri\")\r\n                    \r\nIf infos = vbNo Then\r\n    Exit Sub\r\n    End If\r\n'\r\n```\r\n************************************************************\r\n### Step #2 Semplice controllo iniziale + prima parte intervalli\r\n\r\n```vb\r\n''''\r\nApplication.StatusBar = \"Goditi un Caffe' mentre lavoro per Te....\"\r\n\r\nApplication.ScreenUpdating = False\r\nOn Error GoTo ErrorHandler\r\n\r\n'Step #A Cancella le prime 13 righe\r\nRows(\"1:13\").Delete shift:=xlUp\r\n       \r\n '#B Elimina intervalli di dati vuoti nel primo quadrante\r\n Dim lCel As Integer 'definizione variabile per avere numero ultima riga di un range\r\n    \r\n   lCel = [B3].End(xlDown).Row\r\n   \r\n    Range(\"A1:A\" & lCel & \",C1:F\" & lCel & \",H1:I\" & lCel & \",K1:N\" & lCel & \",P1:P\" & lCel & _\r\n          \",R1:S\" & lCel & \",V1:V\" & lCel & \",X1:Y\" & lCel) _\r\n    .Delete shift:=xlToLeft\r\n''''\r\n```\r\n********************************************************\r\n### Step #3\r\n```vb\r\n'#C  ''area secondo quadrante dati da non considerare quindi cancellare\r\nlCel = Cells.Find(What:=\"INCASSO IVA\", After:=[A1], LookIn:=xlFormulas, _\r\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\r\n        MatchCase:=True, SearchFormat:=False).Row 'activate\r\n \r\nRange(Cells(lCel, \"A\"), Cells(lCel, \"A\").Offset(12, 0)).EntireRow.Delete shift:=xlUp\r\n'''\r\n```\r\n*************************************************************\r\n### Step #4 Lavoro sui quadri di subtotali\r\n```vb\r\n'#D  'Quadrante Dati di subtotale con formattazione numeri e dati negativi in positivi\r\n   \r\n  Dim pCel As Integer ''variabile che conta il numero posizione prima riga range\r\n    pCel = Cells.Find(What:=\"ContoIVA\", After:=[A1], LookIn:=xlFormulas, _\r\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\r\n        MatchCase:=True, SearchFormat:=False).Row\r\n    lCel = Cells.Find(What:=\"SocietÃ  0221\", After:=[A1], LookIn:=xlFormulas, _\r\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\r\n        MatchCase:=True, SearchFormat:=False).Row\r\n ''cancellazione intervalli non necessari con spostamento celle a sinistra\r\n    \r\n Range(\"A\" & pCel & \":A\" & lCel & \",B\" & pCel & \":C\" & lCel & \",E\" & pCel & \":E\" & lCel & _\r\n        \",G\" & pCel & \":G\" & lCel & \",I\" & pCel & \":I\" & lCel & \",K\" & pCel & \":R\" & lCel & _\r\n        \",T\" & pCel & \":U\" & lCel & \",W\" & pCel & \":W\" & lCel) _\r\n  .Delete shift:=xlToLeft\r\n\r\n''''''\r\n'#E  Transformazione e formattazione numeri negativi in positivi\r\nRange(Cells(pCel, \"E\"), Cells(lCel, \"G\")).Select\r\n    Dim rng As Range 'Definisce variabile per ciclo For Each...next\r\n    \r\n    For Each rng In Selection\r\n        If IsNumeric(rng) And Not IsEmpty(rng) Then\r\n        rng.Value = rng * -1\r\n        rng.NumberFormat = \"#,##0.00\"\r\n    End If\r\n    \r\n    Next\r\n     \r\n  '#F  'Cancella ultime righe in quanto non necessarie\r\n  \r\n  pCel = lCel + 1\r\n  lCel = [A1].SpecialCells(xlCellTypeLastCell).Row\r\nRange(Cells(pCel, \"A\"), Cells(lCel, \"A\")).EntireRow.Delete shift:=xlUp\r\n\r\nCells.EntireColumn.AutoFit\r\n[A1].Select\r\n\r\n Application.StatusBar = \"\"\r\n Application.ScreenUpdating = True\r\n Exit Sub\r\n \r\nErrorHandler:\r\nMsgBox \"Interruzione Macro Causa Errore in Registri\" & vbNewLine & \"Contattare Macr@ris\" _\r\n & vbNewLine & vbCrLf & \"Error number:  # \" & Err.Number & vbNewLine & _\r\n  \"Description:==> \" & Err.Description, vbCritical, \"Macr@ris \\Error Macro\"\r\n \r\nApplication.ScreenUpdating = True\r\nApplication.DisplayAlerts = True\r\nApplication.StatusBar = \"\"\r\n\r\nEnd Sub\r\n```\r\n***********************************************\r\n\r\n## Assistenza e Contatto\r\nHai riscontrato qualche problema !? il Tipo qui sara' contento di darti una mano\r\n![Aiuto](https://upload.wikimedia.org/wikipedia/commons/8/8f/Scatophaga_stercoraria_macro_Luc_Viatour.jpg)","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}